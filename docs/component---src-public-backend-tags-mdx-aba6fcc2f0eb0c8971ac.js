(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{IctV:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return o})),n.d(t,"default",(function(){return c}));var a=n("Fcif"),l=n("+I+c"),r=(n("mXGw"),n("/FXl")),s=n("TjRS"),o=(n("aD51"),{});void 0!==o&&o&&o===Object(o)&&Object.isExtensible(o)&&!o.hasOwnProperty("__filemeta")&&Object.defineProperty(o,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/public/backend/tags.mdx"}});var p={_frontmatter:o},b=s.a;function c(e){var t=e.components,n=Object(l.a)(e,["components"]);return Object(r.b)(b,Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Each content support hashtag and tags"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"hashtag is tagged word start by ",Object(r.b)("inlineCode",{parentName:"li"},"#")," in description or content."),Object(r.b)("li",{parentName:"ul"},"tag (sometime named topics) is separated word directly in database")),Object(r.b)("p",null,"in order to support tags and search"),Object(r.b)("p",null,"step 1:"),Object(r.b)("p",null,"Add ",Object(r.b)("inlineCode",{parentName:"p"},"*_tag_data")," relation to migration"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"DbTableHelper::createTagDataTable('blog_tag_data');\n\n")),Object(r.b)("p",null,"Modify content table to have ",Object(r.b)("inlineCode",{parentName:"p"},"tags")),Object(r.b)("p",null,"step 2:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"class CreateBlogTables extends Migration{\n\n    function up(){\n        // add this line to up() method\n        DbTableHelper::tagsColumns($table);\n    }\n}\n")),Object(r.b)("p",null,"Add ",Object(r.b)("inlineCode",{parentName:"p"},"*TagData")," table class, etc"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"<?php\n\nnamespace Modules\\Blog\\Models;\n\nuse Illuminate\\Database\\Eloquent\\Builder;\nuse Illuminate\\Database\\Eloquent\\Relations\\Pivot;\n\n/**\n * Class BlogTagData.\n * @mixin Builder\n * @property int    $id\n * @property int    $item_id\n * @property int    $tag_id\n * @property string $tag_text\n */\nclass BlogTagData extends Pivot\n{\n    /**\n     * @var bool\n     */\n    public $timestamps = false;\n\n    /**\n     * @var string\n     */\n    protected $table = 'blog_tag_data';\n\n    /**\n     * @var string[]\n     */\n    protected $fillable = [\n        'item_id',\n        'tag_id',\n    ];\n}\n")),Object(r.b)("p",null,"step 3."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"class Blog {\n  /**\n   * @return BelongsToMany\n   */\n  public function tagData(): BelongsToMany\n  {\n      return $this->belongsToMany(\n          Tag::class,\n          'blog_tag_data',\n          'item_id',\n          'tag_id'\n      )->using(BlogTagData::class);\n  }\n  // ... other method\n}\n")),Object(r.b)("p",null,"step 4:"),Object(r.b)("p",null,"add tag scope to associate query to filter tag."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"  if ($searchTag != '') {\n       $query = $query->addScope(new TagScope($searchTag));\n  }\n")),Object(r.b)("p",null,"step 5:"),Object(r.b)("p",null,'On search form, there are no tag field, so users used to type "#" before query field to search.'),Object(r.b)("p",null,"WARNING: this step should be improve to skip ASAP."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-php"},"\nclass IndexRequest{\n\n    /**\n     * @return array<string, mixed>\n     */\n    public function validated(): array\n    {\n        $data = parent::validated();\n\n        // .. other process\n\n        if (Str::startsWith($data['q'], '#')) {\n            $data['tag'] = Str::substr($data['q'], 1);\n            $data['q'] = PhpfoxConstant::EMPTY_STRING;\n        }\n\n        return $data;\n    }\n}\n")))}void 0!==c&&c&&c===Object(c)&&Object.isExtensible(c)&&!c.hasOwnProperty("__filemeta")&&Object.defineProperty(c,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/public/backend/tags.mdx"}}),c.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-public-backend-tags-mdx-aba6fcc2f0eb0c8971ac.js.map